
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/99-advanced/pump-bracket.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_99-advanced_pump-bracket.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_99-advanced_pump-bracket.py:

.. _pump_bracket_example:

Visualize Modal Analysis of a Pump Bracket
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The following example demonstrates how to use PyVista to visualize the modal
analysis of a pump bracket based on point arrays representing mode shapes for
different modes of vibration.

**Background**
Modal analysis is the study of the dynamic properties of mechanical structures
in the frequency domain. It is a common technique in structural dynamics,
particularly for automotive, aerospace, and civil engineering applications.

A mode shape is the deformation pattern that occurs at a specific natural
frequency, or mode, of a structure. When a structure is excited by an external
force, it responds at all its natural frequencies with each mode shape being
independent of the others. In this example, we will visualize the mode shapes
to get an understanding of how the pump bracket responds to different modes of
vibration.

.. GENERATED FROM PYTHON SOURCE LINES 22-27

.. code-block:: default

    import numpy as np

    import pyvista as pv
    from pyvista import examples








.. GENERATED FROM PYTHON SOURCE LINES 28-36

Load the dataset
~~~~~~~~~~~~~~~~
Start by loading the dataset using :func:`download_pump_bracket()
<pyvista.examples.downloads.download_pump_bracket>`.

This example demonstrates the visualization of the pump bracket's mode shape,
the representation of its magnitude, and an animation of its displacement. The
dataset used in this example contains 10 mode shapes (disp_0 to disp_9).

.. GENERATED FROM PYTHON SOURCE LINES 36-41

.. code-block:: default


    dataset = examples.download_pump_bracket()
    dataset







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table><tr><th>Header</th><th>Data Arrays</th></tr><tr><td>
    <table>
    <tr><th>UnstructuredGrid</th><th>Information</th></tr>
    <tr><td>N Cells</td><td>124806</td></tr>
    <tr><td>N Points</td><td>250487</td></tr>
    <tr><td>X Bounds</td><td>-5.000e-01, 5.000e-01</td></tr>
    <tr><td>Y Bounds</td><td>-4.000e-01, 0.000e+00</td></tr>
    <tr><td>Z Bounds</td><td>-2.500e-02, 2.500e-02</td></tr>
    <tr><td>N Arrays</td><td>10</td></tr>
    </table>

    </td><td>
    <table>
    <tr><th>Name</th><th>Field</th><th>Type</th><th>N Comp</th><th>Min</th><th>Max</th></tr>
    <tr><td><b>disp_0</b></td><td>Points</td><td>float32</td><td>3</td><td>-5.702e-02</td><td>1.000e+00</td></tr>
    <tr><td>disp_1</td><td>Points</td><td>float32</td><td>3</td><td>-9.769e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_2</td><td>Points</td><td>float32</td><td>3</td><td>-9.165e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_3</td><td>Points</td><td>float32</td><td>3</td><td>-9.808e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_4</td><td>Points</td><td>float32</td><td>3</td><td>-9.494e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_5</td><td>Points</td><td>float32</td><td>3</td><td>-9.759e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_6</td><td>Points</td><td>float32</td><td>3</td><td>-7.134e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_7</td><td>Points</td><td>float32</td><td>3</td><td>-8.740e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_8</td><td>Points</td><td>float32</td><td>3</td><td>-6.784e-01</td><td>1.000e+00</td></tr>
    <tr><td>disp_9</td><td>Points</td><td>float32</td><td>3</td><td>-8.212e-01</td><td>1.000e+00</td></tr>
    </table>

    </td></tr> </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 42-50

Plot the Dataset
~~~~~~~~~~~~~~~~
Choose a mode shape from the available arrays in the dataset. Each "disp_N"
array represents an eigen solution or a single mode shape for a given mode of
vibration.

Plot the 4th mode of the dataset. This is the first torsional mode for the
bracket.

.. GENERATED FROM PYTHON SOURCE LINES 50-66

.. code-block:: default


    cpos = [
        (0.744, -0.502, -0.830),
        (0.0520, -0.160, 0.0743),
        (-0.180, -0.958, 0.224),
    ]

    dataset.plot(
        scalars='disp_3',
        cpos=cpos,
        show_scalar_bar=False,
        ambient=0.2,
        anti_aliasing='fxaa',
    )





.. image-sg:: /examples/99-advanced/images/sphx_glr_pump-bracket_001.png
   :alt: pump bracket
   :srcset: /examples/99-advanced/images/sphx_glr_pump-bracket_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 67-71

Visualize Displaced Mode Shape
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We will now visualize the mode shapes of the pump bracket by displacing the
original dataset using :func:`warp_by_vector <pyvista.DataSetFilters.warp_by_vector>`.

.. GENERATED FROM PYTHON SOURCE LINES 71-87

.. code-block:: default


    # Create a plotter
    pl = pv.Plotter()

    # Add the undeformed pump bracket
    pl.add_mesh(dataset, color="white", opacity=0.5)

    # Add the deformed pump bracket with the mode shape
    warp = dataset.warp_by_vector('disp_2', factor=0.1)
    pl.add_mesh(warp, show_scalar_bar=False, ambient=0.2)

    pl.camera_position = cpos
    pl.enable_anti_aliasing('fxaa')
    pl.show()





.. image-sg:: /examples/99-advanced/images/sphx_glr_pump-bracket_002.png
   :alt: pump bracket
   :srcset: /examples/99-advanced/images/sphx_glr_pump-bracket_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 88-93

Animate the Mode Shape Displacement
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Animate the mode shape's displacement by updating the vertex positions at
each time step. For a more realistic animation, we use a sinusoidal function
to vary the displacement.

.. GENERATED FROM PYTHON SOURCE LINES 93-113

.. code-block:: default


    # feel free to change this to visualize different mode shapes
    mode_shape = 'disp_6'

    # copy the dataset as we will modify its coordinates
    ds = dataset.copy()

    pl = pv.Plotter(off_screen=True)
    pl.add_mesh(ds, lighting=True, color='w')
    pl.camera_position = cpos
    pl.enable_anti_aliasing('fxaa')

    n_frames = 16
    pl.open_gif("pump_bracket_mode_shape.gif")
    for phase in np.linspace(0, 2 * np.pi, n_frames, endpoint=False):
        # use the original unmodified points
        pl.update_coordinates(dataset.points + ds[mode_shape] * np.cos(phase) * 0.05)
        pl.write_frame()

    pl.close()



.. image-sg:: /examples/99-advanced/images/sphx_glr_pump-bracket_003.png
   :alt: pump bracket
   :srcset: /examples/99-advanced/images/sphx_glr_pump-bracket_003.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  14.319 seconds)


.. _sphx_glr_download_examples_99-advanced_pump-bracket.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: pump-bracket.py <pump-bracket.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: pump-bracket.ipynb <pump-bracket.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
