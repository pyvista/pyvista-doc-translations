
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/99-advanced/openfoam-tubes.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_99-advanced_openfoam-tubes.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_99-advanced_openfoam-tubes.py:

.. _openfoam_tubes_example:

Plot CFD Data
-------------
Plot a CFD example from OpenFoam hosted on the public SimScale examples at
`SimScale Project Library <https://www.simscale.com/projects/>`_.

This example dataset was read using the :class:`pyvista.POpenFOAMReader`. See
:ref:`openfoam_example` for a full example using this reader.

.. GENERATED FROM PYTHON SOURCE LINES 12-18

.. code-block:: default


    import numpy as np

    import pyvista as pv
    from pyvista import examples








.. GENERATED FROM PYTHON SOURCE LINES 19-20

Download and load the example dataset.

.. GENERATED FROM PYTHON SOURCE LINES 20-25

.. code-block:: default


    block = examples.download_openfoam_tubes()
    block







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table><tr><th>Information</th><th>Blocks</th></tr><tr><td>
    <table>
    <tr><th>MultiBlock</th><th>Values</th></tr>
    <tr><td>N Blocks</td><td>2</td></tr>
    <tr><td>X Bounds</td><td>-0.128, 0.128</td></tr>
    <tr><td>Y Bounds</td><td>-0.028, 0.028</td></tr>
    <tr><td>Z Bounds</td><td>-0.014, 0.249</td></tr>
    </table>

    </td><td>
    <table>
    <tr><th>Index</th><th>Name</th><th>Type</th></tr>
    <tr><th>0</th><th>internalMesh</th><th>UnstructuredGrid</th></tr>
    <tr><th>1</th><th>boundary</th><th>MultiBlock</th></tr>
    </table>

    </td></tr> </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 26-29

Plot Cross Section
~~~~~~~~~~~~~~~~~~
Plot the outline of the dataset along with a cross section of the flow velocity.

.. GENERATED FROM PYTHON SOURCE LINES 29-43

.. code-block:: default


    # first, get the first block representing the air within the tube.
    air = block[0]

    # generate a slice in the XZ plane
    y_slice = air.slice('y')

    pl = pv.Plotter()
    pl.add_mesh(y_slice, scalars='U', lighting=False, scalar_bar_args={'title': 'Flow Velocity'})
    pl.add_mesh(air, color='w', opacity=0.25)
    pl.enable_anti_aliasing()
    pl.show()





.. image-sg:: /examples/99-advanced/images/sphx_glr_openfoam-tubes_001.png
   :alt: openfoam tubes
   :srcset: /examples/99-advanced/images/sphx_glr_openfoam-tubes_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 44-48

Plot Streamlines - Flow Velocity
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Generate streamlines using :func:`streamlines_from_source()
<pyvista.DataSetFilters.streamlines_from_source>`.

.. GENERATED FROM PYTHON SOURCE LINES 48-59

.. code-block:: default


    # Let's use the inlet as a source. First plot it.
    inlet = block[1][2]
    pl = pv.Plotter()
    pl.add_mesh(inlet, color='b', label='inlet')
    pl.add_mesh(air, opacity=0.2, color='w', label='air')
    pl.enable_anti_aliasing()
    pl.add_legend(face=None)
    pl.show()





.. image-sg:: /examples/99-advanced/images/sphx_glr_openfoam-tubes_002.png
   :alt: openfoam tubes
   :srcset: /examples/99-advanced/images/sphx_glr_openfoam-tubes_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 60-66

Now, actually generate the streamlines. Since the original inlet contains
1000 points, let's reduce this to around 200 points by using every 5th point.

.. note::
   If we wanted a uniform subsampling of the inlet, we could use
   `pyvista/pyacvd <https://github.com/pyvista/pyacvd>`_

.. GENERATED FROM PYTHON SOURCE LINES 66-90

.. code-block:: default


    pset = pv.PointSet(inlet.points[::5])
    lines = air.streamlines_from_source(
        pset,
        vectors='U',
        max_time=1.0,
    )

    pl = pv.Plotter()
    pl.add_mesh(
        lines,
        render_lines_as_tubes=True,
        line_width=3,
        lighting=False,
        scalar_bar_args={'title': 'Flow Velocity'},
        scalars='U',
        rng=(0, 212),
    )
    pl.add_mesh(air, color='w', opacity=0.25)
    pl.enable_anti_aliasing()
    pl.camera_position = 'xz'
    pl.show()





.. image-sg:: /examples/99-advanced/images/sphx_glr_openfoam-tubes_003.png
   :alt: openfoam tubes
   :srcset: /examples/99-advanced/images/sphx_glr_openfoam-tubes_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 91-101

Volumetric Plot - Visualize Turbulent Kinematic Viscosity
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The turbulent kinematic viscosity of a fluid is a derived quantity used in
turbulence modeling to describe the effect of turbulent motion on the
momentum transport within the fluid.

For this example, we will first sample the results from the
:class:`pyvista.UnstructuredGrid` onto a :class:`pyvista.UniformGrid` using
:func:`sample() <pyvista.DataSetFilters.sample>`. This is so we can visualize
it using :func:`add_volume() <pyvista.Plotter.add_volume>`

.. GENERATED FROM PYTHON SOURCE LINES 101-124

.. code-block:: default


    bounds = np.array(air.bounds) * 1.2
    origin = (bounds[0], bounds[2], bounds[4])
    spacing = (0.003, 0.003, 0.003)
    dimensions = (
        int((bounds[1] - bounds[0]) // spacing[0] + 2),
        int((bounds[3] - bounds[2]) // spacing[1] + 2),
        int((bounds[5] - bounds[4]) // spacing[2] + 2),
    )
    grid = pv.UniformGrid(dimensions=dimensions, spacing=spacing, origin=origin)
    grid = grid.sample(air)

    pl = pv.Plotter()
    vol = pl.add_volume(
        grid,
        scalars='nut',
        opacity='linear',
        scalar_bar_args={'title': 'Turbulent Kinematic Viscosity'},
    )
    vol.prop.interpolation_type = 'linear'
    pl.add_mesh(air, color='w', opacity=0.1)
    pl.camera_position = 'xz'
    pl.show()



.. image-sg:: /examples/99-advanced/images/sphx_glr_openfoam-tubes_004.png
   :alt: openfoam tubes
   :srcset: /examples/99-advanced/images/sphx_glr_openfoam-tubes_004.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  7.665 seconds)


.. _sphx_glr_download_examples_99-advanced_openfoam-tubes.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: openfoam-tubes.py <openfoam-tubes.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: openfoam-tubes.ipynb <openfoam-tubes.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
