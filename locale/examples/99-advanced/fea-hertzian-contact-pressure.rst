
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/99-advanced/fea-hertzian-contact-pressure.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_99-advanced_fea-hertzian-contact-pressure.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_99-advanced_fea-hertzian-contact-pressure.py:


.. _hertzian_contact_example:

Visualize Hertzian Contact Stress
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The following example demonstrates how to use PyVista to visualize
Hertzian contact stress between a cylinder and a flat plate.

This example loads a dataset, constructs a line to represent the point of
contact between the cylinder and the block, and samples the stress along that
line. Finally, it plots the dataset and the stress distribution.

**Background**
Hertzian contact stress refers to the stress that occurs between two curved
surfaces that are in contact with each other. It is named after Heinrich Rudolf
Hertz, a German physicist who first described the phenomenon in the late
1800s. Hertzian contact stress is an important concept in materials science,
engineering, and other fields where the behavior of materials under stress is a
critical consideration.

.. GENERATED FROM PYTHON SOURCE LINES 22-29

.. code-block:: default


    import matplotlib.pyplot as plt
    import numpy as np

    import pyvista as pv
    from pyvista import examples








.. GENERATED FROM PYTHON SOURCE LINES 30-35

Load the dataset
~~~~~~~~~~~~~~~~
Start by loading the dataset using :mod:`pyvista.examples` module. This module
provides access to a range of datasets, including FEA (finite element
analysis) datasets that are useful for stress analysis.

.. GENERATED FROM PYTHON SOURCE LINES 35-40

.. code-block:: default


    mesh = examples.download_fea_hertzian_contact_cylinder()
    mesh







.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table style='width: 100%;'><tr><th>Header</th><th>Data Arrays</th></tr><tr><td>
    <table style='width: 100%;'>
    <tr><th>UnstructuredGrid</th><th>Information</th></tr>
    <tr><td>N Cells</td><td>132258</td></tr>
    <tr><td>N Points</td><td>34185</td></tr>
    <tr><td>X Bounds</td><td>-0.000e+00, 2.000e-01</td></tr>
    <tr><td>Y Bounds</td><td>0.000e+00, 2.500e-02</td></tr>
    <tr><td>Z Bounds</td><td>0.000e+00, 3.000e-01</td></tr>
    <tr><td>N Arrays</td><td>16</td></tr>
    </table>

    </td><td>
    <table style='width: 100%;'>
    <tr><th>Name</th><th>Field</th><th>Type</th><th>N Comp</th><th>Min</th><th>Max</th></tr>
    <tr><td>Displacement</td><td>Points</td><td>float64</td><td>3</td><td>-5.000e-04</td><td>2.945e-05</td></tr>
    <tr><td>vonMises</td><td>Points</td><td>float64</td><td>1</td><td>1.316e+02</td><td>1.707e+09</td></tr>
    <tr><td>Stress</td><td>Points</td><td>float64</td><td>6</td><td>-3.055e+09</td><td>5.274e+08</td></tr>
    <tr><td>Strain</td><td>Points</td><td>float64</td><td>6</td><td>-1.937e-02</td><td>1.894e-02</td></tr>
    <tr><td>PrincipalStress 1</td><td>Points</td><td>float64</td><td>1</td><td>-1.787e+09</td><td>2.586e+08</td></tr>
    <tr><td>PrincipalStress 2</td><td>Points</td><td>float64</td><td>1</td><td>-2.594e+09</td><td>3.531e+07</td></tr>
    <tr><td>PrincipalStress 3</td><td>Points</td><td>float64</td><td>1</td><td>-3.078e+09</td><td>1.995e+06</td></tr>
    <tr><td>PrincipalStrain 1</td><td>Points</td><td>float64</td><td>1</td><td>-6.976e-04</td><td>1.448e-02</td></tr>
    <tr><td>PrincipalStrain 2</td><td>Points</td><td>float64</td><td>1</td><td>-1.145e-02</td><td>8.690e-04</td></tr>
    <tr><td>PrincipalStrain 3</td><td>Points</td><td>float64</td><td>1</td><td>-2.787e-02</td><td>-8.375e-10</td></tr>
    <tr><td>StrainEnergyDensity</td><td>Points</td><td>float64</td><td>1</td><td>1.172e-07</td><td>2.307e+07</td></tr>
    <tr><td>PlasticStrain</td><td>Points</td><td>float64</td><td>6</td><td>0.000e+00</td><td>0.000e+00</td></tr>
    <tr><td>EquivalentPlasticStrain</td><td>Points</td><td>float64</td><td>1</td><td>0.000e+00</td><td>0.000e+00</td></tr>
    <tr><td>Rank</td><td>Cells</td><td>float64</td><td>1</td><td>0.000e+00</td><td>1.500e+01</td></tr>
    <tr><td>Material</td><td>Cells</td><td>float64</td><td>1</td><td>0.000e+00</td><td>1.000e+00</td></tr>
    <tr><td>PartID</td><td>Cells</td><td>int32</td><td>1</td><td>1.000e+00</td><td>2.000e+00</td></tr>
    </table>

    </td></tr> </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 41-44

Plot the Dataset
~~~~~~~~~~~~~~~~
Plot the dataset by part ID.

.. GENERATED FROM PYTHON SOURCE LINES 44-48

.. code-block:: default


    mesh.plot(scalars='PartID', cmap=['green', 'blue'], show_scalar_bar=False)









.. tab-set::



   .. tab-item:: Static Scene



            
     .. image-sg:: /examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_001.png
        :alt: fea hertzian contact pressure
        :srcset: /examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_001.png
        :class: sphx-glr-single-img
     


   .. tab-item:: Interactive Scene



       .. offlineviewer:: /home/runner/work/pyvista-doc-translations/pyvista-doc-translations/pyvista/doc/source/examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_001.vtksz






.. GENERATED FROM PYTHON SOURCE LINES 49-53

Creating a Line to Denote the Point of Contact
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Construct a line to represent the point of contact between the cylinder and
the plate.

.. GENERATED FROM PYTHON SOURCE LINES 53-61

.. code-block:: default


    ypos = 0.024
    a = [0.1, ypos, 0.2 - 1e-4]
    b = [0.095, ypos, 0.2 - 1e-4]
    line = pv.Line(a, b, resolution=100)
    line.clear_data()
    line






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">

    <table style='width: 100%;'>
    <tr><th>PolyData</th><th>Information</th></tr>
    <tr><td>N Cells</td><td>1</td></tr>
    <tr><td>N Points</td><td>101</td></tr>
    <tr><td>N Strips</td><td>0</td></tr>
    <tr><td>X Bounds</td><td>9.500e-02, 1.000e-01</td></tr>
    <tr><td>Y Bounds</td><td>2.400e-02, 2.400e-02</td></tr>
    <tr><td>Z Bounds</td><td>1.999e-01, 1.999e-01</td></tr>
    <tr><td>N Arrays</td><td>0</td></tr>
    </table>


    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 62-72

Sampling the Stress along the Line
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
We can sample the Z component stress along the contact edge and compare it
with expected pressure.

The expected values array is the Hertzian contact pressure and is the
analytical solution to the non-adhesive contact problem. Computation of these
values is an exercise left up to the reader (the radius of the cylinder is
0.05). See `Contact Mechanics
<https://en.wikipedia.org/wiki/Contact_mechanics>`_

.. GENERATED FROM PYTHON SOURCE LINES 72-107

.. code-block:: default


    # Sample the stress
    sampled = line.sample(mesh, tolerance=1e-3)
    x_coord = 0.1 - sampled.points[:, 0]
    samp_z_stress = -sampled['Stress'][:, 2]

    # Expected Hertzian contact pressure
    h_pressure = np.array(
        [
            [0.0000, 1718094092],
            [0.0002, 1715185734],
            [0.0004, 1703502649],
            [0.0006, 1683850714],
            [0.0008, 1655946243],
            [0.001, 1619362676],
            [0.0012, 1573494764],
            [0.0014, 1517500856],
            [0.0016, 1450208504],
            [0.0018, 1369953775],
            [0.002, 1274289906],
            [0.0022, 1159408887],
            [0.0024, 1018830677],
            [0.0026, 839747409.8],
            [0.0028, 587969605.2],
            [0.003, 0],
            [0.005, 0],
        ]
    )

    plt.plot(x_coord, samp_z_stress, '.', label='Z Component Stress')
    plt.plot(h_pressure[:, 0], h_pressure[:, 1], label='Hertzian contact pressure')
    plt.legend()
    plt.show()





.. image-sg:: /examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_002.png
   :alt: fea hertzian contact pressure
   :srcset: /examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 108-112

Visualizing the Z Stress Distribution
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
You can now visualize the Z stress distribution. Use :class:`pyvista.Plotter` to
create a plot window and add the dataset to it.

.. GENERATED FROM PYTHON SOURCE LINES 112-129

.. code-block:: default


    pl = pv.Plotter()
    z_stress = np.abs(mesh['Stress'][:, 2])
    pl.add_mesh(
        mesh,
        scalars=z_stress,
        clim=[0, 1.2e9],
        cmap='gouldian',
        scalar_bar_args={'title': 'Z Component Stress (Pa)', 'color': 'w'},
        lighting=True,
        show_edges=False,
        ambient=0.2,
    )
    pl.camera_position = 'xz'
    pl.set_focus(a)
    pl.camera.zoom(2.5)
    pl.show()







.. tab-set::



   .. tab-item:: Static Scene



            
     .. image-sg:: /examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_003.png
        :alt: fea hertzian contact pressure
        :srcset: /examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_003.png
        :class: sphx-glr-single-img
     


   .. tab-item:: Interactive Scene



       .. offlineviewer:: /home/runner/work/pyvista-doc-translations/pyvista-doc-translations/pyvista/doc/source/examples/99-advanced/images/sphx_glr_fea-hertzian-contact-pressure_003.vtksz







.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 2.906 seconds)


.. _sphx_glr_download_examples_99-advanced_fea-hertzian-contact-pressure.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: fea-hertzian-contact-pressure.py <fea-hertzian-contact-pressure.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: fea-hertzian-contact-pressure.ipynb <fea-hertzian-contact-pressure.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
