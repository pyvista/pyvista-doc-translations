<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Contributing &#8212; pyvista-doc-translations  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="CODE_OF_CONDUCT.md"><img alt="Contributor Covenant" src="https://img.shields.io/badge/Contributor%20Covenant-2.1-4baaaa.svg" /></a>
<a class="reference external" href="https://www.codetriage.com/pyvista/pyvista"><img alt="Code Triage" src="https://www.codetriage.com/pyvista/pyvista/badges/users.svg" /></a></p>
<p>We absolutely welcome contributions and we hope that this guide will
facilitate an understanding of the PyVista code repository. It is
important to note that the PyVista software package is maintained on a
volunteer basis and thus we need to foster a community that can support
user questions and develop new features to make this software a useful
tool for all users.</p>
<p>This page is dedicated to outline where you should start with your
question, concern, feature request, or desire to contribute.</p>
<section id="being-respectful">
<h2>Being Respectful<a class="headerlink" href="#being-respectful" title="Link to this heading">¶</a></h2>
<p>Please demonstrate empathy and kindness toward other people, other software,
and the communities who have worked diligently to build (un)related tools.</p>
<p>Please do not talk down in Pull Requests, Issues, or otherwise in a way that
portrays other people or their works in a negative light.</p>
</section>
<section id="cloning-the-source-repository">
<h2>Cloning the Source Repository<a class="headerlink" href="#cloning-the-source-repository" title="Link to this heading">¶</a></h2>
<p>You can clone the source repository from
<a class="reference external" href="https://github.com/pyvista/pyvista">https://github.com/pyvista/pyvista</a> and install the latest version by
running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/pyvista/pyvista.git
<span class="nb">cd</span><span class="w"> </span>pyvista
python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span> <span class="pre">--group</span> <span class="pre">dev</span></code> to also install all of the
packages required for development.</p>
</div>
</section>
<section id="quick-start-development-with-codespaces">
<h2>Quick Start Development with Codespaces<a class="headerlink" href="#quick-start-development-with-codespaces" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://codespaces.new/pyvista/pyvista"><img alt="Open in GitHub Codespaces" src="https://github.com/codespaces/badge.svg" /></a></p>
<p>A dev container is provided to quickly get started. The default container
comes with the repository code checked out on a branch of your choice
and all pyvista dependencies including test dependencies pre-installed.
In addition, it uses the
<a class="reference external" href="https://github.com/devcontainers/features/tree/main/src/desktop-lite">desktop-lite feature</a>
to provide live interaction windows.  Follow directions
<a class="reference external" href="https://github.com/devcontainers/features/tree/main/src/desktop-lite#connecting-to-the-desktop">Connecting to the desktop</a>
to use the live interaction.</p>
<p>Alternatively, an offscreen version using OSMesa libraries and <code class="docutils literal notranslate"><span class="pre">vtk-osmesa</span></code> is available.</p>
</section>
<section id="questions">
<h2>Questions<a class="headerlink" href="#questions" title="Link to this heading">¶</a></h2>
<p>For general questions about the project, its applications, or about
software usage, please create a discussion in the
<a class="reference external" href="https://github.com/pyvista/pyvista/discussions">Discussions</a>
repository where the community can collectively address your questions.</p>
<p>You are also welcome to join us on <a class="reference external" href="https://communityinviter.com/apps/pyvista/pyvista">Slack</a>,
but Slack should be reserved for ad hoc conversations and community engagement
rather than technical discussions.</p>
<p>For critical, high-level project support and engagement, please email
<a class="reference external" href="mailto:info&#37;&#52;&#48;pyvista&#46;org">info<span>&#64;</span>pyvista<span>&#46;</span>org</a> - but please do not use this email for technical support.</p>
<p>For all technical conversations, you are welcome to create an issue on the
<a class="reference external" href="https://github.com/pyvista/pyvista/discussions">Discussions page</a>
which we will address promptly. Through posting on the Discussions page,
your question can be addressed by community members with the needed
expertise and the information gained will remain available for other
users to find.</p>
</section>
<section id="reporting-bugs">
<h2>Reporting Bugs<a class="headerlink" href="#reporting-bugs" title="Link to this heading">¶</a></h2>
<p>If you stumble across any bugs, crashes, or concerning quirks while
using code distributed here, please report it on the <a class="reference external" href="https://github.com/pyvista/pyvista/issues">issues
page</a> with an appropriate
label so we can promptly address it. When reporting an issue, please be
overly descriptive so that we may reproduce it. Whenever possible,
please provide tracebacks, screenshots, and sample files to help us
address the issue.</p>
</section>
<section id="feature-requests">
<h2>Feature Requests<a class="headerlink" href="#feature-requests" title="Link to this heading">¶</a></h2>
<p>We encourage users to submit ideas for improvements to PyVista code
base. Please create an issue on the <a class="reference external" href="https://github.com/pyvista/pyvista/issues">issues
page</a> with a <em>Feature
Request</em> label to suggest an improvement. Please use a descriptive title
and provide ample background information to help the community implement
that functionality. For example, if you would like a reader for a
specific file format, please provide a link to documentation of that
file format and possibly provide some sample files with screenshots to
work with. We will use the issue thread as a place to discuss and
provide feedback.</p>
</section>
<section id="contributing-new-code">
<h2>Contributing New Code<a class="headerlink" href="#contributing-new-code" title="Link to this heading">¶</a></h2>
<p>If you have an idea for how to improve PyVista, please first create an
issue as a feature request which we can use as a discussion thread to
work through how to implement the contribution.</p>
<p>Once you are ready to start coding and develop for PyVista, please see
the <a class="reference external" href="#development-practices">Development Practices</a> section for more
details.</p>
</section>
<section id="licensing">
<h2>Licensing<a class="headerlink" href="#licensing" title="Link to this heading">¶</a></h2>
<p>All contributed code will be licensed under The MIT License found in the
repository. If you did not write the code yourself, it is your
responsibility to ensure that the existing license is compatible and
included in the contributed files or you can obtain permission from the
original author to relicense the code.</p>
</section>
<hr class="docutils" />
<section id="id2">
<h2>Development Practices<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>This section provides a guide to how we conduct development in the
PyVista repository. Please follow the practices outlined here when
contributing directly to this repository.</p>
<section id="guidelines">
<h3>Guidelines<a class="headerlink" href="#guidelines" title="Link to this heading">¶</a></h3>
<p>Through direct access to the Visualization Toolkit (VTK) via direct
array access and intuitive Python properties, we hope to make the entire
VTK library easily accessible to researchers of all disciplines. To
further PyVista towards being a valuable Python interface to VTK, we
need your help to make it even better.</p>
<p>If you want to add one or two interesting analysis algorithms as
filters, implement a new plotting routine, or just fix 1-2 typos - your
efforts are welcome.</p>
<p>There are three general coding paradigms that we believe in:</p>
<ol class="arabic simple">
<li><p><strong>Make it intuitive</strong>. PyVista’s goal is to create an intuitive and
easy to use interface back to the VTK library. Any new features
should have intuitive naming conventions and explicit keyword
arguments for users to make the bulk of the library accessible to
novice users.</p></li>
<li><p><strong>Document everything</strong>. At the least, include a docstring for any
method or class added. Do not describe what you are doing but why you
are doing it and provide a simple example for the new features.</p></li>
<li><p><strong>Keep it tested</strong>. We aim for a high test coverage. See testing for
more details.</p></li>
</ol>
<p>There are two important copyright guidelines:</p>
<ol class="arabic simple">
<li><p>Please do not include any data sets for which a license is not
available or commercial use is prohibited. Those can undermine the
license of the whole projects.</p></li>
<li><p>Do not use code snippets for which a license is not available
(for example from Stack Overflow) or commercial use is prohibited. Those can
undermine the license of the whole projects.</p></li>
</ol>
<p>Please also take a look at our <a class="reference external" href="https://github.com/pyvista/pyvista/blob/main/CODE_OF_CONDUCT.md">Code of
Conduct</a>.</p>
</section>
<section id="contributing-to-pyvista-through-github">
<h3>Contributing to PyVista through GitHub<a class="headerlink" href="#contributing-to-pyvista-through-github" title="Link to this heading">¶</a></h3>
<p>To submit new code to pyvista, first fork the <a class="reference external" href="https://github.com/pyvista/pyvista">pyvista GitHub
Repository</a> and then clone the forked
repository to your computer. Then, create a new branch based on the
<a class="reference external" href="#branch-naming-conventions">Branch Naming Conventions Section</a> in
your local repository.</p>
<p>Next, add your new feature and commit it locally. Be sure to commit
frequently as it is often helpful to revert to past commits, especially
if your change is complex. Also, be sure to test often. See the <a class="reference external" href="#testing">Testing
Section</a> below for automating testing.</p>
<p>When you are ready to submit your code, create a pull request by
following the steps in the <a class="reference external" href="#creating-a-new-pull-request">Creating a New Pull Request
section</a>.</p>
<section id="coding-style">
<h4>Coding Style<a class="headerlink" href="#coding-style" title="Link to this heading">¶</a></h4>
<p>We adhere to <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a>
wherever possible, except that line widths are permitted to go beyond 79
characters to a max of 99 characters for code. This should tend to be
the exception rather than the norm. A uniform code style is enforced
by <a class="reference external" href="https://docs.astral.sh/ruff/formatter/#the-ruff-formatter">ruff format</a> to prevent energy wasted on
style disagreements.</p>
<p>Keyword-only arguments are generally preferred over positional keywords
in function signatures (see <a class="reference external" href="https://peps.python.org/pep-3102/">PEP 3102</a>),
and positional arguments should be limited to just one or two where possible.
Boolean-type arguments should always be keyword-only. This is also
enforced by <code class="docutils literal notranslate"><span class="pre">ruff</span></code>.</p>
<p>As for docstrings, PyVista follows the <code class="docutils literal notranslate"><span class="pre">numpydoc</span></code> style for its docstrings.
Please also take a look at <a class="reference external" href="#docstrings">Docstrings</a>.</p>
<p>Outside of PEP 8, when coding please consider <a class="reference external" href="https://www.python.org/dev/peps/pep-0020/">PEP 20 - The Zen of
Python</a>. When in doubt:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">this</span>
</pre></div>
</div>
<p>PyVista uses <a class="reference external" href="https://pre-commit.com/">pre-commit</a> to enforce PEP8 and other styles
automatically. Please see the <a class="reference external" href="#style-checking">Style Checking section</a> for
further details.</p>
</section>
<section id="documentation-style">
<h4>Documentation Style<a class="headerlink" href="#documentation-style" title="Link to this heading">¶</a></h4>
<p>PyVista follows the <a class="reference external" href="https://developers.google.com/style">Google Developer Documentation Style</a> with the following exceptions:</p>
<ul class="simple">
<li><p>Allow first person pronouns. These pronouns (for example, “We”) refer to
“PyVista Developers”, which can be anyone who contributes to PyVista.</p></li>
<li><p>Future tense is permitted.</p></li>
</ul>
<p>These rules are enforced for all text files (for example, <code class="docutils literal notranslate"><span class="pre">*.md</span></code>, <code class="docutils literal notranslate"><span class="pre">*.rst</span></code>)
and partially enforced for Python source files.</p>
<p>These rules are enforced through the use of <a class="reference external" href="https://vale.sh/">Vale</a> via our
GitHub Actions, and you can run Vale locally with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>vale
vale<span class="w"> </span>--config<span class="w"> </span>doc/.vale.ini<span class="w"> </span>doc<span class="w"> </span>pyvista<span class="w"> </span>examples<span class="w"> </span>./*.rst<span class="w"> </span>--glob<span class="o">=</span><span class="s1">&#39;!*{_build,AUTHORS.rst}*&#39;</span>
</pre></div>
</div>
<p>If you are on Linux or macOS, you can run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>docstyle
</pre></div>
</div>
</section>
<section id="id3">
<h4>Docstrings<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h4>
<p>PyVista uses Python docstrings to create reference documentation for our Python
APIs. Docstrings are read by developers, interactive Python users, and readers
of our online documentation. This section describes how to write these docstrings
for PyVista.</p>
<p>PyVista follows the <code class="docutils literal notranslate"><span class="pre">numpydoc</span></code> style for its docstrings. Please follow the
<a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html">numpydoc Style Guide</a> in all ways except for the following:</p>
<ul class="simple">
<li><p>Be sure to describe all <code class="docutils literal notranslate"><span class="pre">Parameters</span></code> and <code class="docutils literal notranslate"><span class="pre">Returns</span></code> for all public
methods.</p></li>
<li><p>We strongly encourage you to add an example section. PyVista is a visual
library, so adding examples that show a plot will really help users figure
out what individual methods do.</p></li>
<li><p>With optional parameters, use <code class="docutils literal notranslate"><span class="pre">default:</span> <span class="pre">&lt;value&gt;</span></code> instead of <code class="docutils literal notranslate"><span class="pre">optional</span></code>
when the parameter has a default value instead of <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
<p>Sample docstring follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">slice_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">generate_triangles</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create an orthogonal slice through the dataset in the X direction.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : float, optional</span>
<span class="sd">        The X location of the YZ slice. By default this will be the X center</span>
<span class="sd">        of the dataset.</span>

<span class="sd">    generate_triangles : bool, default: False</span>
<span class="sd">        If this is enabled, the output will be all triangles. Otherwise the</span>
<span class="sd">        output will consist of the intersection polygons.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pyvista.PolyData</span>
<span class="sd">        Sliced dataset.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Slice the random hills dataset with one orthogonal plane.</span>

<span class="sd">    &gt;&gt;&gt; from pyvista import examples</span>
<span class="sd">    &gt;&gt;&gt; hills = examples.load_random_hills()</span>
<span class="sd">    &gt;&gt;&gt; slices = hills.slice_x(5, generate_triangles=False)</span>
<span class="sd">    &gt;&gt;&gt; slices.plot(line_width=5)</span>

<span class="sd">    See :ref:`slice_example` for more examples using this filter.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span>  <span class="c1"># implementation goes here</span>
</pre></div>
</div>
<p>Note the following:</p>
<ul class="simple">
<li><p>The parameter definition of <code class="docutils literal notranslate"><span class="pre">generate_triangles</span></code> uses <code class="docutils literal notranslate"><span class="pre">default:</span> <span class="pre">False</span></code>,
and does not include the default in the docstring’s “description” section.</p></li>
<li><p>There is a newline between each parameter. This is different than
<code class="docutils literal notranslate"><span class="pre">numpydoc</span></code>’s documentation where there are no empty lines between parameter
docstrings.</p></li>
<li><p>This docstring also contains a returns section and an examples section.</p></li>
<li><p>The returns section does not include the parameter name if the function has
a single return value. Multiple return values (not shown) should have
descriptive parameter names for each returned value, in the same format as
the input parameters.</p></li>
<li><p>The examples section references the “full example” in the gallery if it
exists.</p></li>
</ul>
<p>In addition, docstring examples which make use of randomly-generated data
should be reproducible. See <a class="reference internal" href="#generating-random-data">Generating Random Data</a> for details.</p>
<p>These standards will be enforced using <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code> using
<code class="docutils literal notranslate"><span class="pre">numpydoc-validate</span></code>, with errors being reported as:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>+-----------------+--------------------------+---------+-------------------------------------------------+
| file            | item                     | check   | description                                     |
+=================+==========================+=========+=================================================+
| cells.py:85     | cells.create_mixed_cells | RT05    | Return value description should finish with &quot;.&quot; |
+-----------------+--------------------------+---------+-------------------------------------------------+
| cells.py:85     | cells.create_mixed_cells | RT05    | Return value description should finish with &quot;.&quot; |
+-----------------+--------------------------+---------+-------------------------------------------------+
| features.py:250 | features.merge           | PR09    | Parameter &quot;datasets&quot; description should finish  |
|                 |                          |         | with &quot;.&quot;                                        |
+-----------------+--------------------------+---------+-------------------------------------------------+
</pre></div>
</div>
<p>If for whatever reason you feel that your function should have an exception to
any of the rules, add an exception to the function either in the
<code class="docutils literal notranslate"><span class="pre">[tool.numpydoc_validation]</span></code> section in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> or add an inline
comment to exclude a certain check. For example, we can omit the <code class="docutils literal notranslate"><span class="pre">Return</span></code>
section from docstrings and skip the RT01 check for magic methods like <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">foo</span><span class="p">):</span>  <span class="c1"># numpydoc ignore=RT01</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize A Class.&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="n">foo</span>
</pre></div>
</div>
<p>See the available validation checks in <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/validation.html">numpydoc Validation</a>.</p>
</section>
<section id="deprecating-features-or-other-backwards-breaking-changes">
<h4>Deprecating Features or other Backwards-Breaking Changes<a class="headerlink" href="#deprecating-features-or-other-backwards-breaking-changes" title="Link to this heading">¶</a></h4>
<p>When implementing backwards-breaking changes within PyVista, care must be taken
to give users the chance to adjust to any new changes. Any non-backwards
compatible modifications should proceed through the following steps:</p>
<ol class="arabic simple">
<li><p>Retain the old behavior and issue a <code class="docutils literal notranslate"><span class="pre">PyVistaDeprecationWarning</span></code> indicating
the new interface you should use.</p></li>
<li><p>Retain the old behavior but raise a <code class="docutils literal notranslate"><span class="pre">pyvista.core.errors.DeprecationError</span></code>
indicating the new interface you must use.</p></li>
<li><p>Remove the old behavior.</p></li>
</ol>
<p>Whenever possible, PyVista developers should seek to have at least three minor
versions of backwards compatibility to give users the ability to update their
software and scripts.</p>
<p>Here’s an example of a soft deprecation of a function. Note the usage of both
the <code class="docutils literal notranslate"><span class="pre">PyVistaDeprecationWarning</span></code> warning and the <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">deprecated</span></code> Sphinx
directive.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pyvista.core.errors</span> <span class="kn">import</span> <span class="n">PyVistaDeprecationWarning</span>


<span class="k">def</span> <span class="nf">addition</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add two numbers.</span>

<span class="sd">    .. deprecated:: 0.37.0</span>
<span class="sd">       Since PyVista 0.37.0, you can use :func:`pyvista.add` instead.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : float</span>
<span class="sd">        First term to add.</span>

<span class="sd">    b : float</span>
<span class="sd">        Second term to add.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    float</span>
<span class="sd">        Sum of the two inputs.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># deprecated 0.37.0, convert to error in 0.40.0, remove 0.41.0</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s1">&#39;`addition` has been deprecated. Use pyvista.add instead&#39;</span><span class="p">,</span>
        <span class="n">PyVistaDeprecationWarning</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add two numbers.&quot;&quot;&quot;</span>

    <span class="k">pass</span>  <span class="c1"># implementation goes here</span>
</pre></div>
</div>
<p>In the above code example, note how a comment is made to convert to an error in
three minor releases and completely remove in the following minor release. For
significant changes, this can be made longer, and for trivial ones this can be
kept short.</p>
<p>Here’s an example of adding error test codes that raise deprecation warning messages.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">warns</span><span class="p">(</span><span class="n">PyVistaDeprecationWarning</span><span class="p">):</span>
    <span class="n">addition</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pv</span><span class="o">.</span><span class="n">_version</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Convert error this function&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pv</span><span class="o">.</span><span class="n">_version</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Remove this function&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above code example, the old test code raises an error in v0.40 and v0.41.
This will prevent us from forgetting to remove deprecations on version upgrades.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When releasing a new version, we need to update the version number to the next
development version. For example, if we are releasing version 0.37.0, the next
development version should be 0.38.0.dev0 which is greater than 0.37.0. This is
why we need to check if the version is greater than 0.40.0 and 0.41.0 in the
test code.</p>
</div>
<p>When adding an additional parameter to an existing method or function, you are
encouraged to use the <code class="docutils literal notranslate"><span class="pre">..</span> <span class="pre">versionadded</span></code> sphinx directive. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Cube</span><span class="p">(</span><span class="n">clean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a cube.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    clean : bool, default: True</span>
<span class="sd">        Whether to clean the raw points of the mesh.</span>

<span class="sd">        .. versionadded:: 0.33.0</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="branch-naming-conventions">
<h4>Branch Naming Conventions<a class="headerlink" href="#branch-naming-conventions" title="Link to this heading">¶</a></h4>
<p>To streamline development, we have the following requirements for naming
branches. These requirements help the core developers know what kind of
changes any given branch is introducing before looking at the code.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fix/</span></code>, <code class="docutils literal notranslate"><span class="pre">patch/</span></code> and <code class="docutils literal notranslate"><span class="pre">bug/</span></code>: any bug fixes, patches, or experimental changes that are
minor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">feat/</span></code>: any changes that introduce a new feature or significant
addition</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">junk/</span></code>: for any experimental changes that can be deleted if gone
stale</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maint/</span></code> and <code class="docutils literal notranslate"><span class="pre">ci/</span></code>: for general maintenance of the repository or CI routines</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc/</span></code>: for any changes only pertaining to documentation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no-ci/</span></code>: for low impact activity that should NOT trigger the CI
routines</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">testing/</span></code>: improvements or changes to testing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">release/</span></code>: releases (see below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">breaking-change/</span></code>: Changes that break backward compatibility</p></li>
</ul>
</section>
<section id="testing">
<h4>Testing<a class="headerlink" href="#testing" title="Link to this heading">¶</a></h4>
<p>After making changes, please test changes locally before creating a pull
request. The following tests will be executed after any commit or pull
request, so we ask that you perform the following sequence locally to
track down any new issues from your changes.</p>
<p>To run our comprehensive suite of unit tests, install PyVista with all
test dependencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="w"> </span>--group<span class="w"> </span><span class="nb">test</span>
</pre></div>
</div>
<p>Then, if you have everything installed, you can run the various test
suites.</p>
</section>
</section>
<section id="unit-testing">
<h3>Unit Testing<a class="headerlink" href="#unit-testing" title="Link to this heading">¶</a></h3>
<p>Run the primary test suite and generate coverage report:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-v<span class="w"> </span>--cov<span class="w"> </span>pyvista
</pre></div>
</div>
<p>Unit testing can take some time, if you wish to speed it up, set the
number of processors with the <code class="docutils literal notranslate"><span class="pre">-n</span></code> flag. This uses <code class="docutils literal notranslate"><span class="pre">pytest-xdist</span></code> to
leverage multiple processes. Example usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-n<span class="w"> </span>&lt;NUMCORE&gt;<span class="w"> </span>--cov<span class="w"> </span>pyvista
</pre></div>
</div>
<p>When submitting a PR, it is highly recommended that all modifications are thoroughly tested.
This is further enforced in the CI by the <a class="reference external" href="https://app.codecov.io/gh/pyvista/pyvista">codecov GitHub action</a>
which has a 90% target, ie. it ensures that 90% of the code modified in the PR is tested.
It should be mentioned that branch coverage is measured on the CI, meaning for examples that both
values of an <code class="docutils literal notranslate"><span class="pre">if</span></code> clause must be tested to ensure full coverage. For more details on branch
coverage, please refer to the <a class="reference external" href="https://coverage.readthedocs.io/en/latest/branch.html">coverage documentation</a>.</p>
<p>If needed, code coverage can be deactivated for specific lines by adding the <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">pragma:</span> <span class="pre">no</span> <span class="pre">cover</span></code> or
<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">pragma:</span> <span class="pre">no</span> <span class="pre">branch</span></code> comments. See the documentation <a class="reference external" href="https://coverage.readthedocs.io/en/latest/branch.html#excluding-code">excluding code</a>
for more details.
However, code coverage exclusion should rarely be used and has to be carefully justified in the PR thread
if no simple alternative solution has been found.</p>
<p>The CI is configured to test multiple vtk versions to ensure sufficient compatibility with vtk.
If needed, the minimum and/or maximum vtk version needed by a specific test can be controlled with a
custom pytest marker <code class="docutils literal notranslate"><span class="pre">needs_vtk_version</span></code>, enabling the following usage (note the inclusive and exclusive signs):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test is skipped if pv.vtk_version_info &lt; (9,1)&quot;&quot;&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test is skipped if pv.vtk_version_info &lt; (9,1)&quot;&quot;&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">(</span><span class="n">less_than</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test is skipped if pv.vtk_version_info &gt;= (9,1)&quot;&quot;&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">(</span><span class="n">at_least</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">less_than</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test is skipped if pv.vtk_version_info &gt;= (9,1) or pv.vtk_version_info &lt; (8,2,0)&quot;&quot;&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">(</span><span class="n">less_than</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test is skipped if pv.vtk_version_info &gt;= (9,1) or pv.vtk_version_info &lt; (8,2,0)&quot;&quot;&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">needs_vtk_version</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">reason</span><span class="o">=</span><span class="s1">&#39;custom reason&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test is skipped with a custom message&quot;&quot;&quot;</span>
</pre></div>
</div>
<section id="vtk-dev-wheel-testing">
<h4>VTK Dev Wheel Testing<a class="headerlink" href="#vtk-dev-wheel-testing" title="Link to this heading">¶</a></h4>
<p>Most unit testing is run with stable VTK releases. However, it is sometimes useful to
run tests with the latest VTK dev wheels. To install these locally, run</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>vtk<span class="w"> </span>--upgrade<span class="w"> </span>--pre<span class="w"> </span>--extra-index-url<span class="w"> </span>https://wheels.vtk.org
</pre></div>
</div>
<p>For CI on GitHub, the <code class="docutils literal notranslate"><span class="pre">vtk-dev-testing</span></code> label can be used to enable unit testing with
the VTK dev wheels. The tests only run when the label is applied.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PR either needs a new commit, e.g. updating the branch from <code class="docutils literal notranslate"><span class="pre">main</span></code>, or to be
closed/re-opened to rerun the CI with the label applied.</p>
</div>
</section>
</section>
<section id="docstring-testing">
<h3>Docstring Testing<a class="headerlink" href="#docstring-testing" title="Link to this heading">¶</a></h3>
<p>Run all code examples in the docstrings with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pytest<span class="w"> </span>-v<span class="w"> </span>--doctest-modules<span class="w"> </span>pyvista
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional testing is also performed on any images generated
by the docstring. See <a class="reference internal" href="#documentation-image-regression-testing">Documentation Image Regression Testing</a>.</p>
</div>
</section>
<section id="style-checking">
<h3>Style Checking<a class="headerlink" href="#style-checking" title="Link to this heading">¶</a></h3>
<p>PyVista follows PEP8 standard as outlined in the <a class="reference external" href="#coding-style">Coding Style section</a> and implements style checking using <a class="reference external" href="https://pre-commit.com/">pre-commit</a>.</p>
<p>To ensure your code meets minimum code styling standards, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pre</span><span class="o">-</span><span class="n">commit</span>
<span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">run</span> <span class="o">--</span><span class="nb">all</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<p>If you have issues related to <code class="docutils literal notranslate"><span class="pre">setuptools</span></code> when installing <code class="docutils literal notranslate"><span class="pre">pre-commit</span></code>, see
<a class="reference external" href="https://github.com/pre-commit/pre-commit/issues/2178#issuecomment-1002163763">pre-commit Issue #2178 comment</a>
for a potential resolution.</p>
<p>You can also install this as a pre-commit hook by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span><span class="o">-</span><span class="n">commit</span> <span class="n">install</span>
</pre></div>
</div>
<p>This way, it’s not possible for you to push code that fails the style
checks. For example, each commit automatically checks that you meet the style
requirements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pre-commit install
$ git commit -m &quot;added my cool feature&quot;
codespell................................................................Passed
ruff.....................................................................Passed
</pre></div>
</div>
<p>The actual installation of the environment happens before the first commit
following <code class="docutils literal notranslate"><span class="pre">pre-commit</span> <span class="pre">install</span></code>. This will take a bit longer, but subsequent
commits will only trigger the actual style checks.</p>
<p>Even if you are not in a situation where you are not performing or able to
perform the above tasks, you can comment <code class="docutils literal notranslate"><span class="pre">pre-commit.ci</span> <span class="pre">autofix</span></code> on a pull
request to manually trigger auto-fixing.</p>
</section>
<section id="notes-regarding-image-regression-testing">
<h3>Notes Regarding Image Regression Testing<a class="headerlink" href="#notes-regarding-image-regression-testing" title="Link to this heading">¶</a></h3>
<p>Since PyVista is primarily a plotting module, it’s imperative we
actually check the images that we generate in some sort of regression
testing. In practice, this ends up being quite a bit of work because:</p>
<ul class="simple">
<li><p>OpenGL software vs. hardware rending causes slightly different images
to be rendered.</p></li>
<li><p>We want our CI (which uses a virtual frame buffer) to match our
desktop images (uses hardware acceleration).</p></li>
<li><p>Different OSes render different images.</p></li>
</ul>
<p>As each platform and environment renders different slightly images
relative to Linux (which these images were built from), so running these
tests across all OSes isn’t optimal. We need to know if
something fundamental changed with our plotting without actually looking
at the plots (like the docs at dev.pyvista.com)</p>
<p>Based on these points, image regression testing only occurs on Linux CI,
and multi-sampling is disabled as that seems to be one of the biggest
difference between software and hardware based rendering.</p>
<p>Image cache is stored here as <code class="docutils literal notranslate"><span class="pre">./tests/plotting/image_cache</span></code>.</p>
<p>Image resolution is kept low at 400x400 as we don’t want to pollute git
with large images. Small variations between versions and environments
are to be expected, so error &lt; <code class="docutils literal notranslate"><span class="pre">IMAGE_REGRESSION_ERROR</span></code> is allowable
(and will be logged as a warning) while values over that amount will
trigger an error.</p>
<p>There are two mechanisms within <code class="docutils literal notranslate"><span class="pre">pytest</span></code> to control image regression
testing, <code class="docutils literal notranslate"><span class="pre">--reset_image_cache</span></code> and <code class="docutils literal notranslate"><span class="pre">--ignore_image_cache</span></code>. For
example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>tests/plotting<span class="w"> </span>--reset_image_cache
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">--reset_image_cache</span></code> creates a new image for each test in
<code class="docutils literal notranslate"><span class="pre">tests/plotting/test_plotting.py</span></code> and is not recommended except for
testing or for potentially a major or minor release. You can use
<code class="docutils literal notranslate"><span class="pre">--ignore_image_cache</span></code> if you’re running on Linux and want to
temporarily ignore regression testing. Realize that regression testing
will still occur on our CI testing.</p>
<p>Images are currently only cached from tests in
<code class="docutils literal notranslate"><span class="pre">tests/plotting/test_plotting.py</span></code>. By default, any test that uses
<code class="docutils literal notranslate"><span class="pre">Plotter.show</span></code> will cache images automatically. To skip image caching,
the <code class="docutils literal notranslate"><span class="pre">verify_image_cache</span></code> fixture can be utilized:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_add_background_image_not_global</span><span class="p">(</span><span class="n">verify_image_cache</span><span class="p">):</span>
    <span class="n">verify_image_cache</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Turn off caching</span>
    <span class="n">plotter</span> <span class="o">=</span> <span class="n">pyvista</span><span class="o">.</span><span class="n">Plotter</span><span class="p">()</span>
    <span class="n">plotter</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">sphere</span><span class="p">)</span>
    <span class="n">plotter</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1"># Turn on caching for further plotting</span>
    <span class="n">verify_image_cache</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This ensures that immediately before the plotter is closed, the current
render window will be verified against the image in CI. If no image
exists, be sure to add the resulting image with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>tests/plotting/image_cache/*
</pre></div>
</div>
<p>During unit testing, if you get image regression failures and would like to
compare the images generated locally to the regression test suite, allow
<a class="reference external" href="https://pytest.pyvista.org/">pytest-pyvista</a> to write all new
generated images to a local directory using the <code class="docutils literal notranslate"><span class="pre">--generated_image_dir</span></code> flag.</p>
<p>For example, the following writes all images generated by <code class="docutils literal notranslate"><span class="pre">pytest</span></code> to
<code class="docutils literal notranslate"><span class="pre">debug_images/</span></code> for any tests in <code class="docutils literal notranslate"><span class="pre">tests/plotting</span></code> whose function name has
<code class="docutils literal notranslate"><span class="pre">volume</span></code> in it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>tests/plotting/<span class="w"> </span>-k<span class="w"> </span>volume<span class="w"> </span>--generated_image_dir<span class="w"> </span>debug_images
</pre></div>
</div>
<p>See <a class="reference external" href="https://pytest.pyvista.org/">pytest-pyvista</a> for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional regression testing is also performed on the documentation
images. See <a class="reference internal" href="#documentation-image-regression-testing">Documentation Image Regression Testing</a>.</p>
</div>
</section>
<section id="notes-regarding-input-validation-testing">
<h3>Notes Regarding Input Validation Testing<a class="headerlink" href="#notes-regarding-input-validation-testing" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pyvista.core.validation</span></code> package has two distinct test suites which
are executed with <code class="docutils literal notranslate"><span class="pre">pytest</span></code>:</p>
<ol class="arabic simple">
<li><p>Regular unit tests in <code class="docutils literal notranslate"><span class="pre">tests/core/test_validation.py</span></code></p></li>
<li><p>Customized unit tests in <code class="docutils literal notranslate"><span class="pre">tests/core/typing</span></code> for testing type hints</p></li>
</ol>
<p>The custom unit tests check that the type hints for the validation package are
correct both statically and dynamically. This is mainly used to check complex and
overloaded function signatures, such as the type hints for <code class="docutils literal notranslate"><span class="pre">validate_array</span></code>
or related functions.</p>
<p>Individual test cases are written as a single line of Python code with the format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reveal_type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>  <span class="c1"># EXPECTED_TYPE: &quot;&lt;T&gt;&quot;</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">arg</span></code> is any argument you want mypy to analyze, and <code class="docutils literal notranslate"><span class="pre">&quot;&lt;T&gt;&quot;</span></code> is the
expected revealed type returned by <code class="docutils literal notranslate"><span class="pre">Mypy</span></code>.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">validate_array</span></code> function, by default, returns a list of floats
when a list of floats is provided at the input. The type hint should reflect this.
To test this, we can write a test case for the function call <code class="docutils literal notranslate"><span class="pre">validate_array([1.0])</span></code>
as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reveal_type</span><span class="p">(</span><span class="n">validate_array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]))</span>  <span class="c1"># EXPECTED_TYPE: &quot;list[float]&quot;</span>
</pre></div>
</div>
<p>The actual revealed type returned by <code class="docutils literal notranslate"><span class="pre">Mypy</span></code> for this test can be generated with
the following command. Note that <code class="docutils literal notranslate"><span class="pre">grep</span></code> is needed to only return the output
from the input string. Otherwise, all <code class="docutils literal notranslate"><span class="pre">Mypy</span></code> errors for the <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> package
are reported.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mypy<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from pyvista.core._validation import validate_array; reveal_type(validate_array([1.0]))&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="se">\&lt;</span>string<span class="se">\&gt;</span>
</pre></div>
</div>
<p>For this test case, the revealed type by <code class="docutils literal notranslate"><span class="pre">Mypy</span></code> is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;builtins.list[builtins.float]&quot;</span>
</pre></div>
</div>
<p>Notice that the revealed type is fully qualified, i.e. includes <code class="docutils literal notranslate"><span class="pre">builtins</span></code>. For
brevity, the custom test suite omits this and requires that only <code class="docutils literal notranslate"><span class="pre">list</span></code> be
included in the expected type. Therefore, for this test case, the <code class="docutils literal notranslate"><span class="pre">EXPECTED_TYPE</span></code>
type is <code class="docutils literal notranslate"><span class="pre">&quot;list[float]&quot;</span></code>, not <code class="docutils literal notranslate"><span class="pre">&quot;builtins.list[builtins.float]&quot;</span></code>. (Similarly, the
package name <code class="docutils literal notranslate"><span class="pre">numpy</span></code> should also be omitted for tests where a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> is
expected.)</p>
<p>Any number of related test cases (one test case per line) may be written and
included in a single <code class="docutils literal notranslate"><span class="pre">.py</span></code> file. The test cases are all stored in
<code class="docutils literal notranslate"><span class="pre">tests/core/typing/validation_cases</span></code>.</p>
<p>The tests can be executed with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>tests/core/typing
</pre></div>
</div>
<p>When executed, a single instance of <code class="docutils literal notranslate"><span class="pre">Mypy</span></code> will statically analyze all the
test cases. The actual revealed types by <code class="docutils literal notranslate"><span class="pre">Mypy</span></code> are compared against the
<code class="docutils literal notranslate"><span class="pre">EXPECTED_TYPE</span></code> is defined by each test case.</p>
<p>In addition, the <code class="docutils literal notranslate"><span class="pre">pyanalyze</span></code> package tests the actual returned
type at runtime to match the statically-revealed type. The
<a class="reference external" href="https://pyanalyze.readthedocs.io/en/latest/reference/runtime.html#pyanalyze.runtime.get_compatibility_error">pyanalyze.runtime.get_compatibility_error</a>
method is used for this. If new typing test cases are added for a new
validation function, the new function must be added to the list of
imports in <code class="docutils literal notranslate"><span class="pre">tests/core/typing/test_validation_typing.py</span></code> so that the
runtime test can call the function.</p>
</section>
<section id="building-the-documentation">
<h3>Building the Documentation<a class="headerlink" href="#building-the-documentation" title="Link to this heading">¶</a></h3>
<p>Install documentation dependencies with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.<span class="w"> </span>--group<span class="w"> </span>docs
</pre></div>
</div>
<p>Build the documentation on Linux or Mac OS with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-C<span class="w"> </span>doc<span class="w"> </span>html
</pre></div>
</div>
<p>Build the documentation on Windows with:</p>
<div class="highlight-winbatch notranslate"><div class="highlight"><pre><span></span><span class="k">cd</span> doc
python -msphinx -M html source _build
python -msphinx -M html . _build
</pre></div>
</div>
<p>The generated documentation can be found in the <code class="docutils literal notranslate"><span class="pre">doc/_build/html</span></code>
directory.</p>
<p>The first time you build the documentation locally will take a while as all the
examples need to be built. After the first build, the documentation should take
a fraction of the time.</p>
<p>To test this locally you need to run a http server in the html directory with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>serve-html
</pre></div>
</div>
<section id="clearing-the-local-build">
<h4>Clearing the Local Build<a class="headerlink" href="#clearing-the-local-build" title="Link to this heading">¶</a></h4>
<p>If you need to clear the locally built documentation, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-C<span class="w"> </span>doc<span class="w"> </span>clean
</pre></div>
</div>
<p>This will clear out everything, including the examples gallery. If you only
want to clear everything except the gallery examples, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-C<span class="w"> </span>doc<span class="w"> </span>clean-except-examples
</pre></div>
</div>
<p>This will clear out the cache without forcing you to rebuild all the examples.</p>
</section>
<section id="parallel-documentation-build">
<h4>Parallel Documentation Build<a class="headerlink" href="#parallel-documentation-build" title="Link to this heading">¶</a></h4>
<p>You can improve your documentation build time on Linux and Mac OS with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make<span class="w"> </span>-C<span class="w"> </span>doc<span class="w"> </span>phtml
</pre></div>
</div>
<p>This effectively invokes <code class="docutils literal notranslate"><span class="pre">SPHINXOPTS=-j</span></code> and can be especially useful for
multi-core computers.</p>
</section>
<section id="documentation-image-regression-testing">
<h4>Documentation Image Regression Testing<a class="headerlink" href="#documentation-image-regression-testing" title="Link to this heading">¶</a></h4>
<p>Image regression testing is performed on all published documentation images.
When the documentation is built, all generated images are automatically
saved to</p>
<blockquote>
<div><p>Build Image Directory: <code class="docutils literal notranslate"><span class="pre">./doc/_build/html/_images</span></code></p>
</div></blockquote>
<p>The regression testing compares these generated images to those stored in</p>
<blockquote>
<div><p>Doc Image Cache: <code class="docutils literal notranslate"><span class="pre">./tests/doc/doc_image_cache</span></code></p>
</div></blockquote>
<p>To test all the images, run <code class="docutils literal notranslate"><span class="pre">pytest</span></code> with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>tests/doc/tst_doc_build.py::test_static_images
</pre></div>
</div>
<p>The tests must be executed explicitly with this command. The name of the test
file is prefixed with <code class="docutils literal notranslate"><span class="pre">tst</span></code>, and not <code class="docutils literal notranslate"><span class="pre">test</span></code> specifically to avoid being
automatically executed by <code class="docutils literal notranslate"><span class="pre">pytest</span></code> (<code class="docutils literal notranslate"><span class="pre">pytest</span></code> collects all tests prefixed
with <code class="docutils literal notranslate"><span class="pre">test</span></code> by default.) This is done since the tests require building the
documentation, and are not a primary form of testing.</p>
<p>When executed, the test will first pre-process the build images. The images are:</p>
<ol class="arabic simple">
<li><p>Collected from the <code class="docutils literal notranslate"><span class="pre">Build</span> <span class="pre">Image</span> <span class="pre">Directory</span></code>.</p></li>
<li><p>Resized to a maximum of 400x400 pixels.</p></li>
<li><p>Saved to a flat directory as JPEG images in <code class="docutils literal notranslate"><span class="pre">./_doc_debug_images</span></code>.</p></li>
</ol>
<p>Next, the pre-processed images in <code class="docutils literal notranslate"><span class="pre">./_doc_debug_images</span></code> are compared to the
cached images in the <code class="docutils literal notranslate"><span class="pre">Doc</span> <span class="pre">Image</span> <span class="pre">Cache</span></code> using <code class="xref py py-func docutils literal notranslate"><span class="pre">pyvista.compare_images()</span></code>.</p>
<p>The tests can fail in three ways. To make it easy to review images for failed tests,
copies of the images are made as follows:</p>
<ol class="arabic">
<li><p>If the comparison between the two images fails:</p>
<blockquote>
<div><ul class="simple">
<li><p>The cache image is copied to <code class="docutils literal notranslate"><span class="pre">./_doc_debug_images_failed/errors/from_cache</span></code></p></li>
<li><p>The build image is copied to <code class="docutils literal notranslate"><span class="pre">./_doc_debug_images_failed/errors/from_build</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p>If an image is in the cache but missing from the build:</p>
<ul class="simple">
<li><p>The cache image is copied to  <code class="docutils literal notranslate"><span class="pre">./_doc_debug_images_failed/errors/from_cache</span></code></p></li>
</ul>
</li>
<li><p>If an image is in the build but missing from the cache:</p>
<ul class="simple">
<li><p>The build image is copied to  <code class="docutils literal notranslate"><span class="pre">./_doc_debug_images_failed/errors/from_build</span></code></p></li>
</ul>
</li>
</ol>
<p>If a warning is generated instead of an error, images are saved to the
<code class="docutils literal notranslate"><span class="pre">warnings</span></code> sub-directory instead of <code class="docutils literal notranslate"><span class="pre">errors</span></code>.</p>
<p>To resolve failed tests, any images in <code class="docutils literal notranslate"><span class="pre">from_build</span></code> or <code class="docutils literal notranslate"><span class="pre">from_cache</span></code>
may be copied to or removed from the <code class="docutils literal notranslate"><span class="pre">Doc</span> <span class="pre">Image</span> <span class="pre">Cache</span></code>. For example,
if adding new docstring examples or plots, the test will initially fail,
and the images in <code class="docutils literal notranslate"><span class="pre">from_build</span></code> may be added to the <code class="docutils literal notranslate"><span class="pre">Doc</span> <span class="pre">Image</span> <span class="pre">Cache</span></code>.
Similarly, if removing examples, the images in <code class="docutils literal notranslate"><span class="pre">from_cache</span></code> may be removed
from the <code class="docutils literal notranslate"><span class="pre">Doc</span> <span class="pre">Image</span> <span class="pre">Cache</span></code>.</p>
<p>If a test is flaky, e.g. the build sometimes generates different images
for the same plot, the multiple versions of the image may be saved to the
flaky test directory <code class="docutils literal notranslate"><span class="pre">./tests/doc/flaky_tests</span></code>. A folder with the same
name as the test image should be created, and all versions of the image
should be stored in this directory. The test will first compare the
build image to the cached image in <code class="docutils literal notranslate"><span class="pre">Doc</span> <span class="pre">Image</span> <span class="pre">Cache</span></code> as normal. If that
comparison fails, the build image is then compared to all images in the
flaky test directory. The test is successful if one of the comparisons
is successful, but a warning will still be issued. If a warning is
emitted by a flaky test, images are saved to the <code class="docutils literal notranslate"><span class="pre">flaky</span></code> sub-directory
instead of <code class="docutils literal notranslate"><span class="pre">warnings</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not necessary to build the documentation images locally in order
to add to or update the doc image cache. The documentation is automatically
built as part of CI testing, and an artifact is generated for (1) all
pre-processed build images and (2) failed test cases. These artifacts may
simply be downloaded from GitHub for review.</p>
<p>The debug images saved with the artifact can also be used to “simulate”
building the documentation images locally. If the images are copied to the
local <code class="docutils literal notranslate"><span class="pre">Build</span> <span class="pre">Image</span> <span class="pre">Directory</span></code>, the tests can then be executed locally for
debugging as though the documentation has already been built.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These tests are intended to provide <em>additional</em> test coverage to ensure the
plots generated by <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> are correct, and should not be used as the
primary source of testing. See <a class="reference internal" href="#docstring-testing">Docstring Testing</a> and
<a class="reference internal" href="#notes-regarding-image-regression-testing">Notes Regarding Image Regression Testing</a> for testing methods which should
be considered first.</p>
</div>
</section>
<section id="interactive-plot-testing">
<h4>Interactive Plot Testing<a class="headerlink" href="#interactive-plot-testing" title="Link to this heading">¶</a></h4>
<p>PyVista’s documentation uses a custom <code class="docutils literal notranslate"><span class="pre">pyvista-plot</span></code> directive to generate
static images as well as interactive plot files. The interactive files have a
<code class="docutils literal notranslate"><span class="pre">.vtksz</span></code> extension and can be relatively large when plotting high-resolution
datasets.</p>
<p>To ensure that the interactive plots do not unnecessarily inflate the size
of the documentation build, a limit is placed on the size of <code class="docutils literal notranslate"><span class="pre">.vtksz</span></code> files.
To test that interactive plots do not exceed this limit, run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest<span class="w"> </span>tests/doc/tst_doc_build.py::test_interactive_plot_file_size
</pre></div>
</div>
<p>If any of these tests fail, the example(s) which generated the plot should be
modified, e.g.:</p>
<ol class="arabic">
<li><p>Simplify any dataset(s) used, e.g. crop, clip, down-sample, decimate, or
otherwise reduce the complexity of the plot.</p></li>
<li><p>Force the plot to be static only.
In docstrings, use the plot directive with the <code class="docutils literal notranslate"><span class="pre">force_static</span></code> option, e.g.:</p>
<blockquote>
<div><div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">pyvista-plot</span><span class="p">::</span>
   <span class="nc">:force_static:</span>

   &gt;&gt;&gt; import pyvista as pv
   &gt;&gt;&gt; # Your example code here
   &gt;&gt;&gt; # ...
   &gt;&gt;&gt; mesh = pv.sphere()
   &gt;&gt;&gt; mesh.plot()
</pre></div>
</div>
</div></blockquote>
<p>In sphinx gallery examples use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_start_ignore</span>
<span class="n">PYVISTA_GALLERY_FORCE_STATIC_IN_DOCUMENT</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1"># sphinx_gallery_end_ignore</span>
</pre></div>
</div>
<p>to disable all plots in the example or use <code class="docutils literal notranslate"><span class="pre">PYVISTA_GALLERY_FORCE_STATIC</span></code>
before the call to <code class="docutils literal notranslate"><span class="pre">plot()</span></code> or <code class="docutils literal notranslate"><span class="pre">show()</span></code> to force static for a single
plot. See <span class="xref std std-ref">add_example_example</span> for more information.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reducing the complexity of the plot is preferred as this will also
also likely reduce the processing times.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="#documentation-image-regression-testing">Documentation Image Regression Testing</a>. for testing performed on
the static images generated by the plot directive.</p>
</div>
</section>
<section id="controlling-cache-for-ci-documentation-build">
<h4>Controlling Cache for CI Documentation Build<a class="headerlink" href="#controlling-cache-for-ci-documentation-build" title="Link to this heading">¶</a></h4>
<p>To reduce build times of the documentation for PRs, cached sphinx gallery, example data, and sphinx build directories
are used in the CI on GitHub.  In some cases, the caching action can cause problems for a specific
PR.  To invalidate a cache for a specific PR, one of the following labels can be applied to the PR.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">no-example-data-cache</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no-gallery-cache</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">no-sphinx-build-cache</span></code></p></li>
</ul>
<p>The PR either needs a new commit, e.g. updating the branch from <code class="docutils literal notranslate"><span class="pre">main</span></code>, or to be closed/re-opened to
rerun the CI with the labels applied.</p>
</section>
</section>
<section id="contributing-to-the-documentation">
<h3>Contributing to the Documentation<a class="headerlink" href="#contributing-to-the-documentation" title="Link to this heading">¶</a></h3>
<p>Documentation for PyVista is generated from three sources:</p>
<ul class="simple">
<li><p>Docstrings from the classes, functions, and modules of <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> using
<a class="reference external" href="https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html">sphinx.ext.autodoc</a>.</p></li>
<li><p>Restructured test from <code class="docutils literal notranslate"><span class="pre">doc/</span></code></p></li>
<li><p>Gallery examples from <code class="docutils literal notranslate"><span class="pre">examples/</span></code></p></li>
</ul>
<p>General usage and API descriptions should be placed within <code class="docutils literal notranslate"><span class="pre">doc/api</span></code> and
the docstrings. Full gallery examples should be placed in <code class="docutils literal notranslate"><span class="pre">examples</span></code>.</p>
<section id="generating-random-data">
<h4>Generating Random Data<a class="headerlink" href="#generating-random-data" title="Link to this heading">¶</a></h4>
<p>All documentation should be reproducible. In particular, any documentation
or examples which use random data should be properly seeded so that the
same random data is generated every time. This enables users to copy code
in the documentation and generate the same results and plots locally.</p>
<p>When using NumPy’s random number generator (RNG) you should create an RNG at
the beginning of your script and use this RNG in the rest of the script. Be
sure to include a seed value. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>  <span class="c1"># generate a floating point number between 0 and 1</span>
</pre></div>
</div>
<p>See Scientific Python’s <a class="reference external" href="https://blog.scientific-python.org/numpy/numpy-rng/">Best Practices for Using NumPy’s Random Number Generators</a> for details.</p>
</section>
<section id="adding-a-new-example">
<h4>Adding a New Example<a class="headerlink" href="#adding-a-new-example" title="Link to this heading">¶</a></h4>
<p>PyVista’s examples come in two formats: basic code snippets demonstrating the
functionality of an individual method or a full gallery example displaying one
or more concepts. Small code samples and snippets are contained in the
<code class="docutils literal notranslate"><span class="pre">doc/api</span></code> directory or within our documentation strings, while the full
gallery examples, meant to be run as individual downloadable scripts, are
contained in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory at the root of this repository.</p>
<p>To add a fully fledged, standalone example, add your example to the
<code class="docutils literal notranslate"><span class="pre">examples</span></code> directory in the root directory of the <a class="reference external" href="https://github.com/pyvista/pyvista/">PyVista Repository</a> within one of the applicable
subdirectories. Should none of the existing directories match the category of
your example, create a new directory with a <code class="docutils literal notranslate"><span class="pre">README.txt</span></code> describing the new
category. Additionally, as these examples are built using the sphinx gallery
extension, follow coding guidelines as established by <a class="reference external" href="https://sphinx-gallery.github.io/stable/index.html">Sphinx-Gallery</a>.</p>
<p>For more details see <span class="xref std std-ref">add_example_example</span>.</p>
</section>
<section id="adding-a-new-dataset">
<h4>Adding a New Dataset<a class="headerlink" href="#adding-a-new-dataset" title="Link to this heading">¶</a></h4>
<p>If you have a dataset that you want to feature or want to include as part
of a full gallery example, add it to <a class="reference external" href="https://github.com/pyvista/vtk-data/">pyvista/vtk-data</a>
and follow the directions there. You will then need to add a new function to
download the dataset in <code class="docutils literal notranslate"><span class="pre">pyvista/examples/downloads.py</span></code>. This might be as easy as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">download_my_new_mesh</span><span class="p">(</span><span class="n">load</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download my new mesh.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_download_dataset</span><span class="p">(</span><span class="n">_dataset_my_new_mesh</span><span class="p">,</span> <span class="n">load</span><span class="o">=</span><span class="n">load</span><span class="p">)</span>


<span class="n">_dataset_my_new_mesh</span> <span class="o">=</span> <span class="n">_SingleFileDownloadableDatasetLoader</span><span class="p">(</span>
    <span class="s1">&#39;mydata/my_new_mesh.vtk&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Note that a separate dataset loading object, <code class="docutils literal notranslate"><span class="pre">_dataset_my_new_mesh</span></code>, should
first be defined outside of the function (with module scope), and the new
<code class="docutils literal notranslate"><span class="pre">download_my_new_mesh</span></code> function should then use this object to facilitate
downloading and loading the dataset. The dataset loader variable should start
with <code class="docutils literal notranslate"><span class="pre">_dataset_</span></code>.</p>
<p>This will enable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyvista</span> <span class="kn">import</span> <span class="n">examples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">download_my_new_mesh</span><span class="p">()</span>
</pre></div>
</div>
<p>For loading complex datasets with multiple files or special processing
requirements, see the private <code class="docutils literal notranslate"><span class="pre">pyvista/examples/_dataset_loader.py</span></code>
module for more details on how to create a suitable dataset loader.</p>
<p>Using a dataset loader in this way will enable metadata to be collected
for the new dataset. A new dataset card titled <code class="docutils literal notranslate"><span class="pre">My</span> <span class="pre">New</span> <span class="pre">Mesh</span> <span class="pre">Dataset</span></code>
will automatically be generated and included in the <a class="reference internal" href="doc/source/api/examples/dataset_gallery.html#dataset-gallery"><span class="std std-ref">Dataset Gallery</span></a>.</p>
<p>In the docstring of the new <code class="docutils literal notranslate"><span class="pre">download_my_new_mesh</span></code> function, be sure
to also include:</p>
<ol class="arabic simple">
<li><p>A sample plot of the dataset in the examples section</p></li>
<li><p>A reference link to the dataset’s new (auto-generated) gallery card
in the see also section</p></li>
</ol>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">download_my_new_mesh</span><span class="p">(</span><span class="n">load</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download my new mesh.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; from pyvista import examples</span>
<span class="sd">    &gt;&gt;&gt; dataset = examples.download_my_new_mesh()</span>
<span class="sd">    &gt;&gt;&gt; dataset.plot()</span>

<span class="sd">    .. seealso::</span>

<span class="sd">       :ref:`My New Mesh Dataset &lt;my_new_mesh_dataset&gt;`</span>
<span class="sd">           See this dataset in the Dataset Gallery for more info.</span>

<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The rst <code class="docutils literal notranslate"><span class="pre">seealso</span></code> directive must be used instead of the
<code class="docutils literal notranslate"><span class="pre">See</span> <span class="pre">Also</span></code> heading due to limitations with how <code class="docutils literal notranslate"><span class="pre">numpydoc</span></code> parses
explicit references.</p>
</div>
</section>
<section id="extending-the-dataset-gallery">
<h4>Extending the Dataset Gallery<a class="headerlink" href="#extending-the-dataset-gallery" title="Link to this heading">¶</a></h4>
<p>If you have multiple related datasets to contribute, or would like to
group any existing datasets together that share similar properties,
the <a class="reference internal" href="doc/source/api/examples/dataset_gallery.html#dataset-gallery"><span class="std std-ref">Dataset Gallery</span></a> can easily be extended to feature these
datasets in a new <a class="reference external" href="https://sphinx-design.readthedocs.io/en/latest/cards.html#card-carousels">card carousel</a>.</p>
<p>For example, to add a new <code class="docutils literal notranslate"><span class="pre">Instrument</span></code> dataset category to <a class="reference internal" href="doc/source/api/examples/dataset_gallery.html#dataset-gallery-category"><span class="std std-ref">Browse Datasets by Category</span></a>
featuring two datasets of musical instruments, e.g.</p>
<ol class="arabic simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">pyvista.examples.downloads.download_guitar()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">pyvista.examples.downloads.download_trumpet()</span></code></p></li>
</ol>
<p>complete the following steps:</p>
<ol class="arabic">
<li><p>Define a new carousel in <code class="docutils literal notranslate"><span class="pre">doc/source/make_tables.py</span></code>, e.g.:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">InstrumentCarousel</span><span class="p">(</span><span class="n">DatasetGalleryCarousel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to generate a carousel of instrument dataset cards.&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;instrument_carousel&#39;</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="s1">&#39;Instrument datasets.&#39;</span>
    <span class="n">badge</span> <span class="o">=</span> <span class="n">CategoryBadge</span><span class="p">(</span><span class="s1">&#39;Instrument&#39;</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;instrument_gallery&#39;</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">fetch_dataset_names</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="s1">&#39;guitar&#39;</span><span class="p">,</span>
                <span class="s1">&#39;trumpet&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> is used internally to define the name of the generated
<code class="docutils literal notranslate"><span class="pre">.rst</span></code> file for the carousel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc</span></code> is a short text description of the carousel which will
appear in the documentation in the header above the carousel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">badge</span></code> is used to give all datasets in the carousel a reference
tag. The <code class="docutils literal notranslate"><span class="pre">ref</span></code> argument for the badge should be a new reference
target (details below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fetch_dataset_names</span></code> should return a list of any/all dataset names
to be included in the carousel. The dataset names should not include
any <code class="docutils literal notranslate"><span class="pre">load_</span></code>, <code class="docutils literal notranslate"><span class="pre">download_</span></code>, or <code class="docutils literal notranslate"><span class="pre">dataset_</span></code> prefix.</p></li>
</ul>
</li>
<li><p>Add the new carousel class to the <code class="docutils literal notranslate"><span class="pre">CAROUSEL_LIST</span></code> variable defined
in <code class="docutils literal notranslate"><span class="pre">doc/source/make_tables.py</span></code>. This will enable the rst to be
auto-generated for the carousel.</p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">doc/source/api/examples/dataset_gallery.rst</span></code> file to
include the new generated <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;_carousel.rst</span></code> file. E.g. to add the
carousel as a new drop-down item, add the following:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="p">..</span> <span class="ow">dropdown</span><span class="p">::</span> Instrument Datasets
   <span class="nc">:name:</span> instrument_gallery

<span class="p">   ..</span> <span class="ow">include</span><span class="p">::</span> /api/examples/dataset-gallery/instrument_carousel.rst
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><p>The dropdown name <code class="docutils literal notranslate"><span class="pre">:name:</span> <span class="pre">&lt;reference&gt;</span></code> should be the badge’s <code class="docutils literal notranslate"><span class="pre">ref</span></code>
variable defined earlier. This will make it so that clicking on the new
badge will link to the new dropdown menu.</p></li>
<li><p>The name of the included <code class="docutils literal notranslate"><span class="pre">.rst</span></code> file should match the <code class="docutils literal notranslate"><span class="pre">name</span></code>
variable defined in the new <code class="docutils literal notranslate"><span class="pre">Carousel</span></code> class.</p></li>
</ul>
</li>
</ol>
<p>After building the documentation, the carousel should now be part
of the gallery.</p>
</section>
</section>
<section id="creating-a-new-pull-request">
<h3>Creating a New Pull Request<a class="headerlink" href="#creating-a-new-pull-request" title="Link to this heading">¶</a></h3>
<p>Once you have tested your branch locally, create a pull request on
<a class="reference external" href="https://github.com/pyvista/pyvista">pyvista GitHub</a> while merging to
main. This will automatically run continuous integration (CI) testing
and verify your changes will work across several platforms.</p>
<p>To ensure someone else reviews your code, at least one other member of
the pyvista contributors group must review and verify your code meets
our community’s standards. Once approved, if you have write permission
you may merge the branch. If you don’t have write permission, the
reviewer or someone else with write permission will merge the branch and
delete the PR branch.</p>
<p>Since it may be necessary to merge your branch with the current release
branch (see below), please do not delete your branch if it is a <code class="docutils literal notranslate"><span class="pre">fix/</span></code>
branch.</p>
</section>
<section id="preview-the-documentation">
<h3>Preview the Documentation<a class="headerlink" href="#preview-the-documentation" title="Link to this heading">¶</a></h3>
<p>For PRs of branches coming from the main pyvista repository, the documentation
is automatically deployed using <a class="reference external" href="https://github.com/nwtgck/actions-netlify">Netifly GitHub actions</a>.
However, new contributors that submit PRs from a fork can download a light-weight documentation CI artifact
that contains a non-interactive subset of the documentation build. It typically weights
500 Mb and is available from the <code class="docutils literal notranslate"><span class="pre">Upload</span> <span class="pre">non-interactive</span> <span class="pre">HTML</span> <span class="pre">documentation</span></code> step of the
<code class="docutils literal notranslate"><span class="pre">Build</span> <span class="pre">Documentation</span></code> CI job.</p>
</section>
<section id="branching-model">
<h3>Branching Model<a class="headerlink" href="#branching-model" title="Link to this heading">¶</a></h3>
<p>This project has a branching model that enables rapid development of
features without sacrificing stability, and closely follows the <a class="reference external" href="https://trunkbaseddevelopment.com/">Trunk
Based Development</a> approach.</p>
<p>The main features of our branching model are:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">main</span></code> branch is the main development branch. All features,
patches, and other branches should be merged here. While all PRs
should pass all applicable CI checks, this branch may be functionally
unstable as changes might have introduced unintended side-effects or
bugs that were not caught through unit testing.</p></li>
<li><p>There will be one or many <code class="docutils literal notranslate"><span class="pre">release/</span></code> branches based on minor
releases (for example <code class="docutils literal notranslate"><span class="pre">release/0.24</span></code>) which contain a stable
version of the code base that is also reflected on PyPI/. Hotfixes
from <code class="docutils literal notranslate"><span class="pre">fix/</span></code> branches should be merged both to main and to these
branches. When necessary to create a new patch release these release
branches will have their <code class="docutils literal notranslate"><span class="pre">pyvista/_version.py</span></code> updated and be tagged
with a semantic version (for example <code class="docutils literal notranslate"><span class="pre">v0.24.1</span></code>). This triggers CI
to push to PyPI, and allow us to rapidly push hotfixes for past
versions of <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> without having to worry about untested
features.</p></li>
<li><p>When a minor release candidate is ready, a new <code class="docutils literal notranslate"><span class="pre">release</span></code> branch
will be created from <code class="docutils literal notranslate"><span class="pre">main</span></code> with the next incremented minor version
(for example <code class="docutils literal notranslate"><span class="pre">release/0.25</span></code>), which will be thoroughly tested. When deemed
stable, the release branch will be tagged with the version
(<code class="docutils literal notranslate"><span class="pre">v0.25.0</span></code> in this case), and if necessary merged with main if any
changes were pushed to it. Feature development then continues on
<code class="docutils literal notranslate"><span class="pre">main</span></code> and any hotfixes will now be merged with this release. Older
release branches should not be deleted so they can be patched as
needed.</p></li>
</ul>
<section id="minor-release-steps">
<h4>Minor Release Steps<a class="headerlink" href="#minor-release-steps" title="Link to this heading">¶</a></h4>
<p>Minor releases are feature and bug releases that improve the
functionality and stability of <code class="docutils literal notranslate"><span class="pre">pyvista</span></code>. Before a minor release is
created the following will occur:</p>
<ol class="arabic">
<li><p>Create a new branch from the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch with name
<code class="docutils literal notranslate"><span class="pre">release/MAJOR.MINOR</span></code> (for example <code class="docutils literal notranslate"><span class="pre">release/0.25</span></code>).</p></li>
<li><p>Update the development version numbers in <code class="docutils literal notranslate"><span class="pre">pyvista/_version.py</span></code>
and commit it (for example <code class="docutils literal notranslate"><span class="pre">0,</span> <span class="pre">26,</span> <span class="pre">'dev0'</span></code>). Push the branch to GitHub
and create a new PR for this release that merges it to main.
Development to main should be limited at this point while effort
is focused on the release.</p></li>
<li><p>Locally run all tests as outlined in the <a class="reference external" href="#testing">Testing
Section</a> and ensure all are passing.</p></li>
<li><p>Locally test and build the documentation with link checking to make
sure no links are outdated. Be sure to run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">clean</span></code> to ensure
no results are cached.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>doc
make<span class="w"> </span>clean<span class="w">  </span><span class="c1"># deletes the sphinx-gallery cache</span>
make<span class="w"> </span>doctest-modules
make<span class="w"> </span>html<span class="w"> </span>-b<span class="w"> </span>linkcheck
</pre></div>
</div>
</li>
<li><p>After building the documentation, open the local build and examine
the examples gallery for any obvious issues.</p></li>
<li><p>It is now the responsibility of the <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> community to
functionally test the new release. It is best to locally install
this branch and use it in production. Any bugs identified should
have their hotfixes pushed to this release branch.</p></li>
<li><p>When the branch is deemed as stable for public release, the PR will
be merged to main. After update the version number in
<code class="docutils literal notranslate"><span class="pre">release/MAJOR.MINOR</span></code> branch, the <code class="docutils literal notranslate"><span class="pre">release/MAJOR.MINOR</span></code> branch
will be tagged with a <code class="docutils literal notranslate"><span class="pre">vMAJOR.MINOR.0</span></code> release. The release branch
will not be deleted. Tag the release with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>tag<span class="w"> </span>v<span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import pyvista as pv; print(pv.__version__)&quot;</span><span class="k">)</span>
</pre></div>
</div>
</li>
<li><p>Please check again that the tag has been created correctly and push the branch and tag.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>HEAD
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>v<span class="k">$(</span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import pyvista as pv; print(pv.__version__)&quot;</span><span class="k">)</span>
</pre></div>
</div>
</li>
<li><p>Create a list of all changes for the release. It is often helpful to
leverage <a class="reference external" href="https://github.com/pyvista/pyvista/compare">GitHub’s compare
feature</a> to see the
differences from the last tag and the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch. Be sure to
acknowledge new contributors by their GitHub username and place
mentions where appropriate if a specific contributor is to thank for
a new feature.</p></li>
<li><p>Place your release notes from previous step in the description for <a class="reference external" href="https://github.com/pyvista/pyvista/releases/new">the new
release on
GitHub</a>.</p></li>
<li><p>Go grab a beer/coffee/water and wait for
<a class="reference external" href="https://github.com/regro/cf-scripts">&#64;regro-cf-autotick-bot</a>
to open a pull request on the conda-forge <a class="reference external" href="https://github.com/conda-forge/pyvista-feedstock">PyVista
feedstock</a>.
Merge that pull request.</p></li>
<li><p>Announce the new release in the Discussions page and
celebrate.</p></li>
</ol>
</section>
<section id="patch-release-steps">
<h4>Patch Release Steps<a class="headerlink" href="#patch-release-steps" title="Link to this heading">¶</a></h4>
<p>Patch releases are for critical and important bugfixes that can not or
should not wait until a minor release. The steps for a patch release</p>
<ol class="arabic simple">
<li><p>Push the necessary bugfix(es) to the applicable release branch. This
will generally be the latest release branch (for example <code class="docutils literal notranslate"><span class="pre">release/0.25</span></code>).</p></li>
<li><p>Update <code class="docutils literal notranslate"><span class="pre">pyvista/_version.py</span></code> with the next patch increment (for example
<code class="docutils literal notranslate"><span class="pre">v0.25.1</span></code>), commit it, and open a PR that merge with the release
branch. This gives the <code class="docutils literal notranslate"><span class="pre">pyvista</span></code> community a chance to validate and
approve the bugfix release. Any additional hotfixes should be outside
of this PR.</p></li>
<li><p>When approved, merge with the release branch, but not <code class="docutils literal notranslate"><span class="pre">main</span></code> as
there is no reason to increment the version of the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.
Then create a tag from the release branch with the applicable version
number (see above for the correct steps).</p></li>
<li><p>If deemed necessary, create a release notes page. Also, open the PR
from conda and follow the directions in step 10 in the minor release
section.</p></li>
</ol>
</section>
</section>
</section>
<section id="dependency-version-policy">
<h2>Dependency version policy<a class="headerlink" href="#dependency-version-policy" title="Link to this heading">¶</a></h2>
<section id="python-and-vtk-dependencies">
<h3>Python and VTK dependencies<a class="headerlink" href="#python-and-vtk-dependencies" title="Link to this heading">¶</a></h3>
<p>We support all supported <a class="reference external" href="https://endoflife.date/python">Python versions</a> and <a class="reference external" href="https://pypi.org/project/vtk/">VTK versions</a> that
support those Python versions. As much as we would prefer to follow
<a class="reference external" href="https://scientific-python.org/specs/spec-0000/">SPEC 0</a>, we follow VTK versions as an interface library of VTK.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">pyvista-doc-translations</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2021, Tetsuo Koyama.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.0.4</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/pyvista/CONTRIBUTING.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>